# Diege Blog v1.1
<p>Diege Blog - это свободно распространяемый open-source движок для блога. Его главными преимуществами является простота установки и управления, а также огромные возможности по изменению внешнего вида через веб-интерфейс. Если раньше приходилось лично копаться в коде и настраивать внешний вид, то в Diege Blog это делается просто и быстро. Любой сможет без труда настроить дизайн блога так, как хочется лично ему. Те же, кто не имеет желания самостоятельно скачивать и запускать Diege Blog, могут бесплатно получить аналогичный полнофункциональный блог на <a href="http://diege.ru">diege.ru</a>. Единственным отличием станет то, что блог будет расположен на поддомене этого сайта, а авторизироваться в нём придётся через основной сайт, а не через сам блог.</p>
<h2>Техническая сторона</h2>
<p>Diege Blog написан целиком на Node.js и требует наличия СУБД MySQL с определёнными таблицами. Все необходимые пакеты перечислены в package.json блога.</p>
<h3>Требуемое ПО</h3>
<ul>
  <li>ОС: Любой Linux дистрибутив (тестировалось на Debian 8.1)</li>
  <li>Node.js (тестировалось на версии 0.12.7)</li>
  <li>MySQL (тестировалось на версии 5.5.44)</li>
</ul>
<h3>Требуемые npm-пакеты</h3>
<ul>
  <li>Express</li>
  <li>Jade</li>
  <li>Body-parser</li>
  <li>Formidable</li>
  <li>Cookie-parser</li>
  <li>Easy-encryption</li>
  <li>Random-token</li>
  <li>Serve-favicon</li>
</ul>
<h3>Рекомендуемые npm-пакеты</h3>
<ul>
  <li>Forever</li>
</ul>
<h2>Установка и настройка</h2>
<i>Примечание: в данном способе установки предполагается, что кроме Diege Blog никакие другие приложения не будут слушать 80 порт. Если планируется установка нескольких экземпляров Diege Blog или Diege Blog с приложением с похожим функционалом, то рекомендуется использовать nginx.</i>
<ol>
  <li>Перед установкой сразу определитесь с названием блога, логином и паролем.</li>
  <li>Установите Node.js и npm.</li>
  <li>Установите MySQL и выполните следующие команды для создания двух необходимых таблиц:
    <pre>CREATE TABLE `%%имя%%_post` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` text NOT NULL,
  `text` longtext NOT NULL,
  `date` text NOT NULL,
  `imgs` text,
  `rubric` text,
  `comment` int(11) NOT NULL DEFAULT '0',
  `pool` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</pre>
    <pre>CREATE TABLE `%%имя%%_comment` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `article` int(11) NOT NULL,
  `text` longtext NOT NULL,
  `author_blog` int(11) NOT NULL,
  `autor_name` varchar(45) DEFAULT NULL,
  `date` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</pre>
  Перед выполнением команд замените %%имя%% на название вашего блога. Допустим, если ваш блог называется `diege`, то таблицы будут носить имена `diege_post` и `diege_comment`.
  </li>
  <li>После этого скачайте архив с <a href="https://github.com/Vladimir37/diege_blog/archive/master.zip">последней версией Diege Blog</a> и распакуйте его в любое удобное для вас место.</li>
  <li>Переместитесь внутрь папки из распакованного архива и выполните команду <b>npm install</b>. Она автоматически установит все необходимые пакеты.</li>
  <li>Осталось лишь настроить сам блог. Перейдите в <b>diege_blog-master/blog</b> и откройте файл <b>db.json</b>. Это настройки подключения к базе данных. Вам достаточно изменить "node_db" на на установленный вами пароль и "diege_main" на имя базы данных, в которой расположены созданные ранее таблицы.</li>
  <li>Теперь откройте файл <b>specification.json</b> там же. Здесь нужно изменить "named" на имя вашего блога, которое упоминается в названии таблиц. Далее измените "log" на ваш логин, а "pass" на ваш пароль. В пароле рекомендуется использовать как цифры, так и буквы. И последнее, но крайне важное действие! Необходимо изменить ваш личный ключ доступа. Он является вашей гарантией защиты от взлома, а потому его ни в коем случае не рекомендуется оставлять по умолчанию. Замените "12345678" любым набором символов, однако чтобы избежать лишних нагрузок с шифровкой и расшифровкой ключа, но при этом сохранить надёжную защиту, рекомендуется использовать восемь любых чисел.</li>
  <li>Готово! Теперь можете запускать блог! Это делается с помощью команды <b>node diege_blog.js</b>, либо, если вы ранее установили пакет Forever, то с помощью <b>forever start diege_blog.js</b>.</li>
  <li>Для того, чтобы зайти на блог с правами администратора, перейдите по адресу <b><i>ваш 80 порт</i>/login</b>. После ввода логина и пароля вам будут предоставлены все полномочия хозяина блога. Подробнее про управление Diege Blog можно почитать <a href="http://diege.ru/help">здесь</a>.</li>
</ol>
